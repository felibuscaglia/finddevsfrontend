{"ast":null,"code":"import _regeneratorRuntime from\"/Users/felipebuscaglia/Henry/finddevsfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Users/felipebuscaglia/Henry/finddevsfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/felipebuscaglia/Henry/finddevsfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/felipebuscaglia/Henry/finddevsfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/felipebuscaglia/Henry/finddevsfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useLayoutEffect}from'react';import style from'./AddJob.module.css';import axios from'axios';import{Hint}from'react-autocomplete-hint';import{connect}from'react-redux';import{Editor}from'@tinymce/tinymce-react';import Loading from'../../Media/Loading.gif';import jwt from'jsonwebtoken';import{setUserInfo as _setUserInfo}from'../../Actions/index';import{Link}from'react-router-dom';import{Alert}from'reactstrap';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faDoorOpen}from'@fortawesome/free-solid-svg-icons';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AddJob(_ref){var projectID=_ref.projectID,skills=_ref.skills,setUserInfo=_ref.setUserInfo;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),project=_useState2[0],setProject=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedSkills=_useState4[0],setSelectedSkills=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),input=_useState6[0],setInput=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];function asyncUseEffect(_x,_x2){return _asyncUseEffect.apply(this,arguments);}function _asyncUseEffect(){_asyncUseEffect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(username,userId){var projectData,userFound;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return setUserInfo(username);case 2:_context.prev=2;_context.next=5;return axios.get(\"/projects/\".concat(projectID));case 5:projectData=_context.sent;_context.next=8;return projectData.data.users.find(function(member){return member.id===userId;});case 8:userFound=_context.sent;if(!userFound||userFound.userXprojects.isFounder===false||projectData.data.isDeleted)window.location.replace('/error');setProject(projectData.data);setTimeout(function(){setLoading(false);},1000);_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](2);console.log(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return _asyncUseEffect.apply(this,arguments);}useLayoutEffect(function(){var user=jwt.decode(JSON.parse(localStorage.getItem('user')));if(user){asyncUseEffect(user.username,user.id);}else window.location.replace('/error');},[]);function removeSkill(e){setSelectedSkills(selectedSkills.filter(function(skill){return skill.label!==e.target.name;}));}function addSkill(e){if(e.keyCode===13){var found=skills.find(function(skill){return skill.label.toLowerCase()===e.target.value.toLowerCase();});var found2=selectedSkills.find(function(skill){return skill.label.toLowerCase()===e.target.value.toLowerCase();});if(found&&!found2){setSelectedSkills(selectedSkills.concat(found));e.target.value='';}}}function handleInputChange(e){setInput(_objectSpread(_objectSpread({},input),{},_defineProperty({},e.target.name,e.target.value)));}function handleDescriptionChange(e){setInput(_objectSpread(_objectSpread({},input),{},{description:e.target.getContent()}));}function handleSubmit(){setLoading(true);var justIDs=selectedSkills.map(function(skill){return skill.id;});if(!input.title||!input.description)return setError('Please complete all the necessary fields.');axios.post(\"/jobs/\".concat(project.id),{jobInfo:input,skills:justIDs}).then(function(res){return window.location.replace(\"/project/jobPanel/\".concat(project.id));}).catch(function(err){setError('Something failed—we are sorry!');setLoading(false);});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{id:style.fixedDiv,children:[/*#__PURE__*/_jsx(\"div\",{id:style.logoDiv,children:/*#__PURE__*/_jsx(Link,{to:\"/project/profile/\".concat(projectID),children:/*#__PURE__*/_jsx(\"img\",{alt:\"Project logo\",src:project.logo,id:style.logo})})}),/*#__PURE__*/_jsx(Link,{id:style.link,to:\"/project/jobPanel/\".concat(projectID),children:/*#__PURE__*/_jsxs(\"span\",{className:\"font200\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faDoorOpen}),\" Go back\"]})})]}),/*#__PURE__*/_jsx(\"div\",{id:style.secondDiv,children:!loading?/*#__PURE__*/_jsxs(\"div\",{id:style.innerDiv,children:[/*#__PURE__*/_jsx(\"h1\",{id:style.mainSpan,className:\"font800\",children:\"Post a job\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"displayFlexColumn\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font600\",children:\"Title *\"}),/*#__PURE__*/_jsx(\"input\",{maxLength:\"255\",name:\"title\",onChange:function onChange(e){return handleInputChange(e);},className:style.input})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"displayFlexColumn\",children:[/*#__PURE__*/_jsx(\"span\",{className:style.title,children:\"Description *\"}),window.innerWidth>385&&/*#__PURE__*/_jsx(Editor,{onChange:function onChange(e){return handleDescriptionChange(e);},apiKey:\"5ltasngibqdlae7csndk86vmlye4eqd8jhk6fsiza0lpz5db\",init:{selector:'textarea',content_style:\"@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@200;300;400;600;700;800;900&display=swap'); body { font-family: 'Nunito';}\",branding:false,height:300,width:723,menubar:false,plugins:['advlist autolink lists link image','charmap print preview anchor help','searchreplace visualblocks code','insertdatetime media table paste wordcount'],toolbar:'undo redo | formatselect | bold italic | \\\n                            alignleft aligncenter alignright | \\\n                            bullist numlist outdent indent'}}),/*#__PURE__*/_jsx(\"textarea\",{id:style.textarea,placeholder:\"Describe your project\"})]}),/*#__PURE__*/_jsxs(\"div\",{id:style.skillDiv,children:[/*#__PURE__*/_jsx(\"span\",{className:\"font600\",children:\"Skills\"}),/*#__PURE__*/_jsx(\"div\",{id:style.selectedSkills,children:selectedSkills.map(function(skill){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{style:{background:skill.strongColor,color:skill.softColor},name:skill.label,onClick:function onClick(e){return removeSkill(e);},id:style.skillBtn,children:skill.label})},skill.id);})}),/*#__PURE__*/_jsx(Hint,{options:skills,children:/*#__PURE__*/_jsx(\"input\",{onKeyDown:function onKeyDown(e){return addSkill(e);},className:style.inputSkill,placeholder:\"Press enter to add a skill\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"advert\",children:\"If you don't find your skill, please contact us.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,id:style.uploadBtn,children:\"Post job\"}),error&&/*#__PURE__*/_jsx(Alert,{id:style.alert,color:\"danger\",children:error})]})]}):/*#__PURE__*/_jsx(\"img\",{alt:\"Loading GIF\",className:style.loading,src:Loading})})]});}function mapStateToProps(state){return{skills:state.allSkills,user:state.userInfo};}function mapDispatchToProps(dispatch){return{setUserInfo:function setUserInfo(username){return dispatch(_setUserInfo(username));}};}export default connect(mapStateToProps,mapDispatchToProps)(AddJob);","map":{"version":3,"sources":["/Users/felipebuscaglia/Henry/finddevsfrontend/src/Screens/AddJob/AddJob.jsx"],"names":["React","useState","useLayoutEffect","style","axios","Hint","connect","Editor","Loading","jwt","setUserInfo","Link","Alert","FontAwesomeIcon","faDoorOpen","AddJob","projectID","skills","project","setProject","selectedSkills","setSelectedSkills","input","setInput","loading","setLoading","error","setError","asyncUseEffect","username","userId","get","projectData","data","users","find","member","id","userFound","userXprojects","isFounder","isDeleted","window","location","replace","setTimeout","console","log","user","decode","JSON","parse","localStorage","getItem","removeSkill","e","filter","skill","label","target","name","addSkill","keyCode","found","toLowerCase","value","found2","concat","handleInputChange","handleDescriptionChange","description","getContent","handleSubmit","justIDs","map","title","post","jobInfo","then","res","catch","err","fixedDiv","logoDiv","logo","link","secondDiv","innerDiv","mainSpan","innerWidth","selector","content_style","branding","height","width","menubar","plugins","toolbar","textarea","skillDiv","background","strongColor","color","softColor","skillBtn","inputSkill","uploadBtn","alert","mapStateToProps","state","allSkills","userInfo","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState, useLayoutEffect } from 'react';\nimport style from './AddJob.module.css';\nimport axios from 'axios';\nimport { Hint } from 'react-autocomplete-hint';\nimport { connect } from 'react-redux';\nimport { Editor } from '@tinymce/tinymce-react';\nimport Loading from '../../Media/Loading.gif';\nimport jwt from 'jsonwebtoken';\nimport { setUserInfo } from '../../Actions/index';\nimport { Link } from 'react-router-dom';\nimport { Alert } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faDoorOpen } from '@fortawesome/free-solid-svg-icons';\n\nfunction AddJob({ projectID, skills, setUserInfo }) {\n\n    const [project, setProject] = useState({});\n    const [selectedSkills, setSelectedSkills] = useState([]);\n    const [input, setInput] = useState({});\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(false);\n\n    async function asyncUseEffect(username, userId) {\n        await (setUserInfo(username));\n        try {\n            const projectData = await axios.get(`/projects/${projectID}`);\n            const userFound = await projectData.data.users.find(member => member.id === userId);\n            if (!userFound || userFound.userXprojects.isFounder === false || projectData.data.isDeleted) window.location.replace('/error');\n            setProject(projectData.data);\n            setTimeout(() => {\n                setLoading(false);\n            }, 1000)\n        } catch (err) {\n            console.log(err)\n        }\n    }\n\n    useLayoutEffect(() => {\n        const user = jwt.decode(JSON.parse(localStorage.getItem('user')))\n        if (user) {\n            asyncUseEffect(user.username, user.id);\n        } else window.location.replace('/error');\n    }, [])\n\n    function removeSkill(e) {\n        setSelectedSkills(selectedSkills.filter(skill => skill.label !== e.target.name))\n    }\n\n    function addSkill(e) {\n        if (e.keyCode === 13) {\n            var found = skills.find(skill => skill.label.toLowerCase() === e.target.value.toLowerCase());\n            var found2 = selectedSkills.find(skill => skill.label.toLowerCase() === e.target.value.toLowerCase());\n            if (found && !found2) {\n                setSelectedSkills(selectedSkills.concat(found));\n                e.target.value = '';\n            }\n        }\n    }\n\n    function handleInputChange(e) {\n        setInput({\n            ...input,\n            [e.target.name]: e.target.value\n        })\n    }\n\n    function handleDescriptionChange(e) {\n        setInput({\n            ...input,\n            description: e.target.getContent()\n        })\n    }\n\n    function handleSubmit() {\n        setLoading(true);\n        const justIDs = selectedSkills.map(skill => skill.id);\n\n        if (!input.title || !input.description) return setError('Please complete all the necessary fields.')\n\n        axios.post(`/jobs/${project.id}`, { jobInfo: input, skills: justIDs })\n            .then(res => window.location.replace(`/project/jobPanel/${project.id}`))\n            .catch(err => {\n                setError('Something failed—we are sorry!');\n                setLoading (false);\n            })\n    }\n\n    return (\n        <div>\n            <div id={style.fixedDiv}>\n                <div id={style.logoDiv}>\n                    <Link to={`/project/profile/${projectID}`}><img alt=\"Project logo\" src={project.logo} id={style.logo} /></Link>\n                </div>\n                <Link id={style.link} to={`/project/jobPanel/${projectID}`}><span className='font200'><FontAwesomeIcon icon={faDoorOpen} /> Go back</span></Link>\n            </div>\n            <div id={style.secondDiv}>\n                {!loading ?\n                    <div id={style.innerDiv}>\n                        <h1 id={style.mainSpan} className='font800'>Post a job</h1>\n                        <div className='displayFlexColumn'>\n                            <span className='font600'>Title *</span>\n                            <input maxLength='255' name='title' onChange={(e) => handleInputChange(e)} className={style.input} />\n                        </div>\n                        <div className='displayFlexColumn'>\n                            <span className={style.title}>Description *</span>\n                            {window.innerWidth > 385 && <Editor\n                                onChange={(e) => handleDescriptionChange(e)}\n                                apiKey='5ltasngibqdlae7csndk86vmlye4eqd8jhk6fsiza0lpz5db'\n                                init={{\n                                    selector: 'textarea',\n                                    content_style:\n                                        \"@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@200;300;400;600;700;800;900&display=swap'); body { font-family: 'Nunito';}\",\n                                    branding: false,\n                                    height: 300,\n                                    width: 723,\n                                    menubar: false,\n                                    plugins: [\n                                        'advlist autolink lists link image',\n                                        'charmap print preview anchor help',\n                                        'searchreplace visualblocks code',\n                                        'insertdatetime media table paste wordcount',\n                                    ],\n                                    toolbar:\n                                        'undo redo | formatselect | bold italic | \\\n                            alignleft aligncenter alignright | \\\n                            bullist numlist outdent indent'\n                                }}\n                            />}\n                            <textarea id={style.textarea} placeholder='Describe your project'></textarea>\n                        </div>\n                        <div id={style.skillDiv}>\n                            <span className='font600'>Skills</span>\n                            <div id={style.selectedSkills}>\n                                {selectedSkills.map(skill =>\n                                    <div key={skill.id}>\n                                        <button style={{ background: skill.strongColor, color: skill.softColor }} name={skill.label} onClick={(e) => removeSkill(e)} id={style.skillBtn}>{skill.label}</button>\n                                    </div>\n                                )}\n                            </div>\n                            <Hint options={skills}>\n                                <input onKeyDown={(e) => addSkill(e)} className={style.inputSkill} placeholder='Press enter to add a skill' />\n                            </Hint>\n                            <span className='advert'>If you don't find your skill, please contact us.</span>\n                        </div>\n                        <div>\n                            <button onClick={handleSubmit} id={style.uploadBtn}>Post job</button>\n                            {error &&\n                                <Alert id={style.alert} color=\"danger\">\n                                    {error}\n                                </Alert>\n                            }\n                        </div>\n                    </div> :\n                    <img alt=\"Loading GIF\" className={style.loading} src={Loading} />}\n            </div>\n        </div>\n    )\n}\n\nfunction mapStateToProps(state) {\n    return {\n        skills: state.allSkills,\n        user: state.userInfo\n    }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        setUserInfo: username => dispatch(setUserInfo(username))\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddJob);"]},"metadata":{},"sourceType":"module"}